#title Emacs Muse

<contents>

* What's Muse
[[http://mwolson.org/projects/EmacsMuse.html][Emacs Muse]] is an authoring and publishing environment for Emacs. It simplifies the process of writings documents and publishing them to various output formats. Muse uses a very simple Wiki-like format as input.

Muse consists of two main parts: an enhanced text-mode for authoring documents and navigating within Muse projects, and a set of publishing styles for generating different kinds of output.

* 使用心得
** 高亮源代码
老版本的Muse可以参考这篇帖子[[../download/MuseConfig.tar.bz2][MuseConfig.tar.bz2]]。新版本的Muse已经支持源代码着色了，只要有htmlize.el就行，
<example>
<src lang="c">
#include <stdlib.h>

char *unused;

int main (int argc, char *argv[])
{
    puts("Hello, world!\n");
}
</src>
</example>

这样最后生成的html代码中内嵌有颜色和字体控制的css代码，如果想使用在.css文件中定义的风格，需要修改htmlize.el中的部分内容（参考[[http://www.mygooglest.com/fni/site-map.html]]）
<src lang="emacs-lisp">
;; override output type `inline-css' used for htmlizing a region
(defun htmlize-region-for-paste (beg end)
  "Htmlize the region and return just the HTML as a string.
This forces the `css' style and only returns the HTML body, but
without the BODY tag. This should make it useful for inserting
the text to another HTML buffer."
  (let* ((htmlize-output-type 'css)  ; was `inline-css'
         (htmlbuf (htmlize-region beg end)))
    (unwind-protect
        (with-current-buffer htmlbuf
          (buffer-substring (plist-get htmlize-buffer-places 'content-start)
                            (plist-get htmlize-buffer-places 'content-end)))
      (kill-buffer htmlbuf))))
</src>

** 页面预览
默认设置下C-c C-v可以在浏览器中打开当前页面，打开的浏览器是和.html文件关联的那个。

** 多级目录发布
以我的学习笔记为例
<src lang="emacs-lisp">
(setq muse-project-alist
      `(
	("StudyNotes"
	 (,@(muse-project-alist-dirs "~/muse/source/study")
	  :default "index")
	 ,@(muse-project-alist-styles "~/muse/source/study"
				      "~/muse/html/study"
				      "html"))
	))
</src>

* 推荐链接
 - [[http://learn.tsinghua.edu.cn:8080/2005211356/][叶文彬的主页]] 里面有不少好用的elisp函数，另外所有页面的muse源代码是公开的。
 - [[http://learn.tsinghua.edu.cn:8080/2004211031/publish/Default/WelcomePage.html][bethoven 的个人主页]] 用Emacs Wiki生成的一个主页，我的主页css就是在它的基础上改的。
